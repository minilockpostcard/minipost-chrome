// Generated by CoffeeScript 1.8.0
(function() {
  var miniPostAppWindow, start;

  miniPostAppWindow = void 0;

  start = function(window) {
    console.log('Opening miniLock Postcard Window', window);
    window.minipost.router.writePostcard();
    return window.chrome.commands.onCommand.addListener(function(command) {
      console.log('Command:', command);
      if (command === "Write") {
        window.minipost.router.writePostcard({});
      }
      if (command === "Unlock") {
        window.minipost.router.unlockPostcard({});
      }
      if (command === "Index") {
        window.minipost.router.showIndex({});
      }
      if (command === "Open") {
        return window.minipost.router.unlockPostcard({});
      }
    });
  };

  chrome.app.runtime.onLaunched.addListener(function() {
    if (miniPostAppWindow) {
      return miniPostAppWindow.focus();
    } else {
      return chrome.app.window.create("window.html", {
        minWidth: 1220,
        minHeight: 660,
        height: 960
      }, function(appWindow) {
        miniPostAppWindow = appWindow;
        return miniPostAppWindow.contentWindow.onload = function(event) {
          return start(event.currentTarget, appWindow);
        };
      });
    }
  });

}).call(this);
